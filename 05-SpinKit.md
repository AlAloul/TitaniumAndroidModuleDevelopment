Ti.SpinKit
==========

<img src="https://raw.githubusercontent.com/ybq/AndroidSpinKit/master/art/screen.gif" width="180px" height="300px"/>

Lets look to the SpinKit. This is an extended ActivityIndicator. We have only constructor (create…) arguments, no methods at life time.  We go into lib folder an found the class [SpnKitView](https://github.com/ybq/Android-SpinKit/blob/master/library/src/main/java/com/github/ybq/android/spinkit/SpinKitView.java). Lets analyze the constructor:

```java
public SpinKitView(Context context) {
        this(context, null);
    }

    public SpinKitView(Context context, AttributeSet attrs) {
        this(context, attrs, R.attr.SpinKitViewStyle);
    }

    public SpinKitView(Context context, AttributeSet attrs, int defStyleAttr) {
        this(context, attrs, defStyleAttr, R.style.SpinKitView);
    }

    @TargetApi(Build.VERSION_CODES.LOLLIPOP)
    public SpinKitView(Context context, AttributeSet attrs, int defStyleAttr, int defStyleRes) {
        super(context, attrs, defStyleAttr, defStyleRes);
        TypedArray a = context.obtainStyledAttributes(attrs, R.styleable.SpinKitView, defStyleAttr,
                defStyleRes);
        mStyle = Style.values()[a.getInt(R.styleable.SpinKitView_SpinKit_Style, 0)];
        mColor = a.getColor(R.styleable.SpinKitView_SpinKit_Color, Color.WHITE);
        a.recycle();
        init();
        setIndeterminate(true);
    }
```

The first method with only one argument calls the second *this(context, null);*. OK, then the second method calls the third and adds *R.attr.SpinKitViewStyle*.  OOps, here we have the evil R.class. We have to avoid this pattern. With other words, we cannot use this class as 1:1 copy. The plan is to use the simple (first) constructor and inject the parameters later programmatically and in the end we can call *init()* and *setIndeterminate(true)*.

SpinnerViewProxy.java
---------------------

With this class name we can call the spinner with:
```javascript
Module.createSpinnerView({…args…});
```

Now the class:
```java
/**
 * This file was auto-generated by the Titanium Module SDK helper for Android
 * Appcelerator Titanium Mobile
 * Copyright (c) 2009-2010 by Appcelerator, Inc. All Rights Reserved.
 * Licensed under the terms of the Apache Public License
 * Please see the LICENSE included with this distribution for details.
 *
 */
package de.appwerft.spinkit;

import org.appcelerator.kroll.KrollDict;

import android.graphics.Color;
import android.widget.LinearLayout;
import android.widget.LinearLayout.LayoutParams;

//import org.appcelerator.kroll.KrollProxy;
import org.appcelerator.kroll.annotations.Kroll;
import org.appcelerator.titanium.proxy.TiViewProxy;
import org.appcelerator.titanium.view.TiUIView;

import com.github.ybq.android.spinkit.SpinKitView;
import com.github.ybq.android.spinkit.sprite.Sprite;
import com.github.ybq.android.spinkit.style.*;

import android.app.Activity;

// This proxy can be created by calling Spin.createExample({message: "hello world"})
@Kroll.proxy(creatableInModule = SpinKitModule.class)
public class SpinnerViewProxy extends TiViewProxy {
	public int spinnerStyle = 0;
	public int spinnerColor = Color.parseColor("#ffffff");
	private SpinnerView mView;
	public SpinnerViewProxy() {
		super();
	}

	@Override
	public TiUIView createView(Activity activity) {
		mView = new SpinnerView(this);
		mView.getLayoutParams().autoFillsHeight = true;
		mView.getLayoutParams().autoFillsWidth = true;
		return mView;
	}

	@Override
	public void handleCreationDict(KrollDict options) {
		super.handleCreationDict(options);
		if (options.containsKeyAndNotNull("type")) {
			spinnerStyle = options.getInt("type");
		}
		if (options.containsKeyAndNotNull("color")) {
			spinnerColor = Color.parseColor(options.getString("color"));
		}
	}

	private class SpinnerView extends TiUIView {
		SpinKitView view;

		public SpinnerView(final TiViewProxy proxy) {
			super(proxy);
			LinearLayout container = new LinearLayout(proxy.getActivity());
			container.setLayoutParams(new LayoutParams(
					LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
			view = new SpinKitView(proxy.getActivity());
			view.initView(spinnerColor, spinnerStyle);
			view.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, 1000));
			view.refreshDrawableState();
			Sprite sprite = null;
			switch (spinnerStyle) {
			case 0:
				sprite = new RotatingPlane();
				break;
			case 1:
				sprite = new DoubleBounce();
				break;
			case 2:
				sprite = new Wave();
				break;
			case 3:
				sprite = new WanderingCubes();
				break;
			case 4:
				sprite = new Pulse();
				break;
			case 5:
				sprite = new ChasingDots();
				break;
			case 6:
				sprite = new ThreeBounce();
				break;
			case 7:
				sprite = new Circle();
				break;
			case 8:
				sprite = new CubeGrid();
				break;
			case 9:
				sprite = new FadingCircle();
				break;
			case 10:
				sprite = new FoldingCube();
				break;
			case 11:
				sprite = new RotatingCircle();
				break;
			}
			sprite.setColor(spinnerColor);
			view.setIndeterminateDrawable(sprite);
			container.addView(view);
			setNativeView(container);
		}

		@Override
		public void processProperties(KrollDict d) {
			super.processProperties(d);
		}
	}

}
```

